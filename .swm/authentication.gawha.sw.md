---
id: gawha
title: Authentication
file_version: 1.1.2
app_version: 1.8.3
---

Entry Point for placio authentication

<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->

### ðŸ“„ placio-auth/src/app.ts

```typescript
1      import 'reflect-metadata';
2      import compression from 'compression';
3      import cookieParser from 'cookie-parser';
4      import cors from 'cors';
5      import express from 'express';
6      import helmet from 'helmet';
7      import hpp from 'hpp';
8      import morgan from 'morgan';
9      import { connect, set } from 'mongoose';
10     import swaggerJSDoc from 'swagger-jsdoc';
11     import swaggerUi from 'swagger-ui-express';
12     import { NODE_ENV, PORT, LOG_FORMAT, ORIGIN, CREDENTIALS } from '@config';
13     import { dbConnection } from '@database';
14     import { Routes } from '@interfaces/routes.interface';
15     import { ErrorMiddleware } from '@middlewares/error.middleware';
16     import { logger, stream } from '@utils/logger';
17
18     // mongodb+srv://dozie:<password>@cluster0.jmf27wp.mongodb.net/?retryWrites=true&w=majority
19
20     export class App {
21       public app: express.Application;
22       public env: string;
23       public port: string | number;
24
25       constructor(routes: Routes[]) {
26         this.app = express();
27         this.env = NODE_ENV || 'development';
28         this.port = PORT || 3004;
29
30         this.connectToDatabase();
31         this.initializeMiddlewares();
32         this.initializeRoutes(routes);
33         this.initializeSwagger();
34         this.initializeErrorHandling();
35       }
36
37       public listen() {
38         this.app.listen(this.port, () => {
39           logger.info(`=================================`);
40           logger.info(`======= ENV: ${this.env} =======`);
41           logger.info(`ðŸš€ App listening on the port ${this.port}`);
42           logger.info(`=================================`);
43         });
44       }
45
46       public getServer() {
47         return this.app;
48       }
49
50       private async connectToDatabase() {
51         if (this.env !== 'production') {
52           set('debug', true);
53         }
54
55         await connect(dbConnection.url);
56       }
57
58       private initializeMiddlewares() {
59         this.app.use(morgan(LOG_FORMAT, { stream }));
60         this.app.use(cors({ origin: ORIGIN, credentials: CREDENTIALS }));
61         this.app.use(hpp());
62         this.app.use(helmet());
63         this.app.use(compression());
64         this.app.use(express.json());
65         this.app.use(express.urlencoded({ extended: true }));
66         this.app.use(cookieParser());
67       }
68
69       private initializeRoutes(routes: Routes[]) {
70         logger.info('=================================');
71         logger.info('======= Initializing Routes =====');
72         routes.forEach(route => {
73           this.app.use('/api/v1', route.router);
74         });
75       }
76
77       private initializeSwagger() {
78         const options = {
79           swaggerDefinition: {
80             info: {
81               title: 'Placio Auth API',
82               version: '1.0.0',
83               description: 'Placio Auth API',
84             },
85           },
86           apis: ['swagger.yaml'],
87         };
88
89         const specs = swaggerJSDoc(options);
90         this.app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(specs));
91       }
92
93       private initializeErrorHandling() {
94         this.app.use(ErrorMiddleware);
95       }
96     }
```

<br/>

The Code helps to run the server

<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->

### ðŸ“„ placio-auth/src/server.ts

```typescript
1      import { App } from '@/app';
2      import { AuthRoute } from '@routes/auth.route';
3      import { UserRoute } from '@routes/users.route';
4      import { ValidateEnv } from '@utils/validateEnv';
5
6      ValidateEnv();
7
8      const app = new App([new UserRoute(), new AuthRoute()]);
9
10     app.listen();
```

<br/>

Configurations and envs for docs

<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->

### ðŸ“„ placio-auth/src/config/index.ts

```typescript
1      import { config } from 'dotenv';
2      config({ path: `.env.${process.env.NODE_ENV || 'development'}.local` });
3
4      export const CREDENTIALS = process.env.CREDENTIALS === 'true';
5      export const { NODE_ENV, PORT, SECRET_KEY, LOG_FORMAT, LOG_DIR, ORIGIN } = process.env;
6      export const { DB_HOST, DB_PORT, DB_DATABASE, DB_USERNAME, DB_PASSWORD } = process.env;
```

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBcGxhY2lvLWFwaSUzQSUzQUNOQy1UZWNobm9sb2dpZXM=/docs/gawha).
